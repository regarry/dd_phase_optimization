# ==========================================
# 1. OPTIMIZATION & TRAINING LOOP
# ==========================================
random_seed: 1234
ntrain: 100               # default 10000 how many bead volumes per epoch
nvalid: 1                  # default 1000
batch_size: 1              # Training batch size
batch_size_gen: 1          # Data generation batch size (default 2)
max_epochs: 1000
initial_learning_rate: 0.01

# Learning Rate Scheduler
learning_rate_scheduler_factor: 0.1
learning_rate_scheduler_patience: 5
learning_rate_scheduler_patience_min_lr: 1.0e-6

# Loss Function & Weights
weights: [1.0, 1.0, 2.0]   # cross entropy loss weights (must be floats)
tv_loss_weight: 0.0        # Weight for the total variation loss of the phase mask
z_range_cost_function: [0, 0] # the range +- from z=0 that is considered ground truth

# ==========================================
# 2. OPTICAL SYSTEM & HARDWARE
# ==========================================
wavelength: 561.0e-9       # [m]
refractive_index: 1.0      # We assume propagation is in air
numerical_aperture: 0.6    # Relates to the resolution of the detection objective

# Lenses (Focal Lengths in [m])
focal_length_1: 300.0e-3
focal_length_2: 75.0e-3    # focal length of the second lens
focal_length_3: 75.0e-3
focal_length_4: 300.0e-3
focal_length_5: 20.0e-3    # illumination objective lens (mitutoyo 10x M PLAN APO obj with 200mm tube lens)
fresnel_lens_focal_length: 1.0e-3

# Optical Setup Configuration
lens_approach: "4f"        # "fourier_lens" or "4f" or "lensless"
lenless_prop_distance: 50.0e-3 # Propagation distance from SLM for lensless imaging [m]
angular_spectrum_method: True
aperature: False           # Typo in original (aperture), keeping as is for code compatibility

# ==========================================
# 3. SLM & PHASE MASK
# ==========================================
slm_px: 9.2e-6             # Physical pixel size of the SLM [m]
phase_mask_pixel_size: 256 # Number of pixels on the SLM side (resolution)
initial_phase_mask: "empty"
phase_mask_upsample_factor: 9 # Scale factor for phase mask upsampling (simulation vs physical)

# ==========================================
# 4. SIMULATION GRID & RESOLUTION
# ==========================================
#px: 9.2e-6 / 9               # Simulation grid pixel size [m]

# *****************want to change this to input meters not px
bead_volume: [482, 482, 96] # [x, y, z] volume of imaging in px (camera coordinates)
ratio_input_output_image_size: 1 # default with Unet 1, with ResNet 4

# ==========================================
# 5. BEAD & SAMPLE GENERATION
# ==========================================
num_particles_range: [200, 201] # [min, max] emitters per image. Strong GPU: [450, 550]
bead_radius: 1.0           # pixels 1.0 default
#particle_spatial_range_xy: [15, 985] # [min, max] px, to avoid edges (default 200 um volume)
#particle_spatial_range_z: [-49, 49, 1] # [start, stop, step] px

# ==========================================
# 6. ILLUMINATION & BEAM PROPERTIES
# ==========================================
ori_intensity: 20000       # arbitrary units
illumination_scaling_factor: 1.0e-2
laser_beam_FWHC: 7.0e-3    # [m] FWHM of Gaussian beam
bessel_cone_angle_degrees: 0.4
max_intensity_conv: 8.0e+10 # convol: 5.0e+10, fresnel: 5e4
max_intensity_fresnel: 5.0e+4

# Beam Profiler Specifics
z_min_mm: -2.0             # Min z-position for beam profile [mm]
z_max_mm: 2.0              # Max z-position for beam profile [mm]
y_min_mm: -0.5             # Min y-position for beam profile [mm]
y_max_mm: 0.5              # Max y-position for beam profile [mm]
num_z_steps: 200           # Simulation steps/planes across the z-range

# ==========================================
# 7. CAMERA & NOISE MODEL
# ==========================================
quantum_efficiency: 0.75   # (0-1)
dark_current_mean: 1000    # Mean dark current electrons per pixel
read_noise_std: 200        # Read noise std dev in electrons RMS
camera_gain: 0.7           # Electrons per ADU
camera_max_adu: 65535      # 16-bit depth

# ==========================================
# 8. CNN ARCHITECTURE & INPUTS
# ==========================================
use_unet: true
conv3d: False
dropout: 0.5
num_classes: 3             # 0=background, 1=bead, 2=between beads
z_depth_list: [0]          # z slices input into the cnn
z_coupled_ratio: 0.5
z_coupled_spacing_range: [2, 5]

# ==========================================
# 9. PATHS & FILES
# ==========================================
data_path: "beads_img_defocus"
psf_image_path: "psf_images"
path_save: "data_mask_learning"
path_train: "traininglocations"
bfp_dir: "back_focal_plane"
training_data_path: "training_results"

# ==========================================
# 10. PSF GENERATION UTILS
# ==========================================
#psf_width_pixels: 101      # How big will be the psf image
#psf_edge_remove: 15
psf_keep_radius: 15
z_stop: 50.0e-6           # float (end of z-stack for psf generation)